@{
    ViewBag.PageHead = "User List";
    Layout =  "~/Views/Shared/HomeLayoutAdmin.cshtml";
}

    <script src="~/Scripts/jquery-1.10.2.js"></script>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <script src="http://code.angularjs.org/1.4.8/angular.js"></script>
    <script src="http://code.angularjs.org/1.4.8/angular-resource.js"></script>
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" />
    <script src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.0.js"></script>
<link href="/Content/css/styles.css" rel="stylesheet">
<link href="/Content/css/bootstrap.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script>
        $(function () {
            $("#dialog-confirm").dialog({
                resizable: false,
                height: 180,
                modal: true,
                autoOpen: false,

            });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('#dialog-confirm').parent('div').css('position', 'relative');
        });

    </script>



    <script>
     var app = angular.module('MyForm', ['ui.bootstrap', 'ngResource']);
     app.controller('myCtrl', function ($scope, $http, personService) {
         $scope.personData = null;


         personService.GetAllRecords().then(function (d) {
           
             $scope.personData = d.data; // Success
             $scope.predicate = 'firstname';
             $scope.reverse = true;
             $scope.currentPage = 1;
             $scope.order = function (predicate) {
                 $scope.reverse = ($scope.predicate === predicate) ? !$scope.reverse : false;
                 $scope.predicate = predicate;
             };
        
             $scope.totalItems = $scope.personData.length;
             $scope.numPerPage = 10;
             $scope.paginate = function (value) {
                 var begin, end, index;
                 begin = ($scope.currentPage - 1) * $scope.numPerPage;
                 end = begin + $scope.numPerPage;
                 index = $scope.personData.indexOf(value);
                 return (begin <= index && index < end);
             };
        
             // Delete product details
             $scope.delete = function () {
              
                 var index = document.getElementById('hiddenVal').value;
                 var id = document.getElementById('hiddenValId').value;
             
                 $http({
                     method: 'Post',
                     url: '/XpanelAdmin/Delete/' + id,
                 }).then(function successCallback(response) {

                
                     $scope.personData.splice(index, 1);

                    


                     document.getElementById('success').style.display = "block";
                     $("#dialog-confirm").dialog("close");
                 }, function errorCallback(response) {
                     alert("Error : " + response.data.ExceptionMessage);
                 });

                
             };

             $scope.deletepopup = function (index,id) {

                 $('#hiddenVal').val(index);

                 $('#hiddenValId').val(id);
               
          

                 $("#dialog-confirm").dialog("open");
             }
             $scope.cancel = function (index) {

              
                 $("#dialog-confirm").dialog("close");
             }

             $scope.ChangeStatus = function (id,status)
             {
                

                 $http
                     ({
                     method: 'Post',
                     url: '/XpanelAdmin/ChangeStatus?id=' + id + "&status="+status,
                 }).then(function successCallback(response) {
                     personService.GetAllRecords().then(function (d) {
                         $scope.personData = d.data;
                     });

                    
                     document.getElementById('success').style.display = "block";
                     document.getElementById('success').innerHTML="Record Updated Successfully."
                  
                 }, function errorCallback(response) {
                     alert("Error : " + response.data.ExceptionMessage);
                 });


             }



         }
     );
     });
     app.factory('personService', function ($http) {
         var fac = {};
         fac.GetAllRecords = function () {
         
             return $http.get('/XpanelAdmin/GetAll');
         }
         return fac;
     });
    </script>


    <style>



        /*.navbar-toggle {
        
        
        display:none;
        
        }

        .odd {
          
            color: #747576;
        }

        .table th {
        
         color:#747576;
        
        }

        .table th a {
        
          color:#747576;
        }

        td th a {
        
        color:#747576;
        }

        td th {
            height: 30px;
            min-width: 100px;
        }

        thead {
            background-color: #DDDCDC;
            color: white;
            height: 30px;
        }

        header h3{
            margin:0px;
            padding:31px;
        }

        header {
        
        height:85px;
       
        margin:0px;
        background:#428bca;

        }

        .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus{
background-color:#000 !important;
color:#FFF !important;
border:#000 !important;
}

        .ng-binding {
        
        color:#000 !important;
        }

        footer h3 {
        
        margin:0px;
        }

        footer{

         background:#000;
         height:60px !important;
         margin:0px;
         padding:5px;

        }

        .table_scroll {
        overflow-x:auto !important;
        
        
        
        }

        .table {
        
        
         overflow-x:auto !important;
        }
        .table-responsive {
        
        border:none !important;
       
        }
        .container-fluid {
       
        }*/


         .addedit-box .Buttons .cancel-button {
        float:left;
        border:solid 1px #dfdfdf;
        padding:5px 10px 5px 10px;
        background-color:#FAFAFA;
        color:#000000;
        font-size:15px;
    }
    .addedit-box .Buttons .delete-button {
        float:left;
        border:solid 1px #dfdfdf;
        padding:5px 10px 5px 10px;

        background-color:#FAFAFA;
        color:#000000;
        font-size:15px;
    }


    </style>



<div ng-app="MyForm">
    <div ng-controller="myCtrl">
        <div id="dialog-confirm" title="Delete" style="display:none;">
            <div class="addedit-box">
                <input type="hidden" id="hiddenValId" value="0" />
                <input type="hidden" id="hiddenVal" value="0" />
                <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>Are you sure want to Delete?</p>
                <div class="Buttons" style="padding-top:50px;">
                    <input type="button" class="delete-button" id="btndelete" value="OK" ng-click="delete()" style="margin-right:12px;" />
                    <input type="button" class="cancel-button" id="btncancel" value="Cancel" ng-click="cancel()" />
                </div>
                <div class="clear"></div>
            </div>

        </div>



        <div style="padding-left:254px;">
           
            <hr />

            <div class="alert alert-success" id="success" style="display:none;">
                <strong></strong><span>Record Deleted Successfully.</span>
            </div>
            <table style="margin-bottom:20px;" class="table-responsive">
                <tr>
                    <td style="border:none !important;">&nbsp;&nbsp;Search </td>
                    <td>&nbsp;</td>
                    <td> <input type="text" class="form-control" ng-model="search.firstname" /></td>

                </tr>
            </table>

           
      
                            <div class="table_scroll">
                                <table class="table table-striped table-responsive">
                                    <thead>
                                        <tr>
                                            <th>Action</th>
                                            <th>
                                                <a ng-click="order('firstname')">Name</a>
                                            </th>


                                            <th>Email Id</th>
                                            <th>Phone No.</th>
                                            <th>Access/Denied</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr ng-repeat="user in personData | orderBy:predicate:reverse | filter:paginate| filter:search" ng-class-odd="'odd'">
                                            <td>
                                                @*<button ng-click="delete($index)" class="dafault">*@
                                                <button ng-click="deletepopup($index,user.id)" class="dafault">

                                                    <i class="fa fa-trash" aria-hidden="true"></i>

                                                </button>
                                            </td>
                                            <td hidden="hidden">{{user.id}}</td>
                                            <td>{{ user.firstname}}</td>

                                            <td>{{ user.email}}</td>
                                            <td>{{ user.phone1}}</td>
                                            <td ng-if="user.active == true"><img src="~/Content/images/icon_active.png" style="cursor:pointer;" ng-click="ChangeStatus(user.id,user.active)" /></td>

                                            <td ng-if="user.active == false"><img src="~/Content/images/icon_inactive.png" style="cursor:pointer;" ng-click="ChangeStatus(user.id,user.active)" /></td>

                                        </tr>
                                    </tbody>
                                </table>
                                <pagination total-items="totalItems" ng-model="currentPage"
                                            max-size="5" boundary-links="true"
                                            items-per-page="numPerPage" class="pagination-sm">
                                </pagination>


                            </div>
                        </div>
                      

            </div>


 
</div>
